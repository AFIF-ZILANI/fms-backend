generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Employee {
  id             String           @id @default(uuid())
  email          String?          @unique
  name           String
  mobile         String
  address        String?
  salary         Float?
  join_date      DateTime         @default(now())
  updated_at     DateTime         @updatedAt
  rating         Float?           @default(0)
  online_contact ContactMethod[]
  role           EmployeeRoleName
  avatar_id      String?          @unique
  avatar         Images?          @relation(fields: [avatar_id], references: [id])
}

model Admin {
  id          String        @id @default(uuid())
  email       String        @unique
  name        String
  mobile      String
  created_at  DateTime      @default(now())
  updated_at  DateTime      @updatedAt
  avatar_id   String?       @unique
  avatar      Images?       @relation(fields: [avatar_id], references: [id])
  Medications Medications[]
  Vaccination Vaccination[]
}

model Customer {
  id             String          @id @default(uuid())
  name           String
  email          String?         @unique
  mobile         String
  address        String?
  rating         Float?          @default(0)
  company        String?
  is_registered  Boolean         @default(false)
  online_contact ContactMethod[]
  created_at     DateTime        @default(now())
  updated_at     DateTime        @updatedAt
  avatar_id      String?         @unique
  avatar         Images?         @relation(fields: [avatar_id], references: [id])
  Sales          Sales[]
}

model Supplier {
  id               String                   @id @default(uuid())
  name             String
  email            String?                  @unique
  mobile           String
  address          String?
  rating           Float?                   @default(0)
  role             SupplierRoleName
  type             SupplierSupplyCategory[]
  company          String?
  online_contact   ContactMethod[]
  created_at       DateTime                 @default(now())
  updated_at       DateTime                 @updatedAt
  avatar_id        String?                  @unique
  Batch            Batch[]
  StockTransaction StockTransaction[]
  avatar           Images?                  @relation(fields: [avatar_id], references: [id])
  Items            Item[]
   @@index([name])
}

model Doctor {
  id             String          @id @default(uuid())
  name           String
  email          String?         @unique
  mobile         String
  address        String?
  specialty      String?
  position       String?
  degrees        String[]
  rating         Float?          @default(0)
  sector         String?
  institution    String?
  is_registered  Boolean         @default(false)
  online_contact ContactMethod[]
  created_at     DateTime        @default(now())
  updated_at     DateTime        @updatedAt
  avatar_id      String?         @unique
  avatar         Images?         @relation(fields: [avatar_id], references: [id])
  Medications    Medications[]
  Vaccination    Vaccination[]
}

model Pharmacist {
  id             String          @id @default(uuid())
  name           String
  email          String?         @unique
  mobile         String
  address        String?
  rating         Float?          @default(0)
  institution    String?
  is_registered  Boolean         @default(false)
  online_contact ContactMethod[]
  created_at     DateTime        @default(now())
  updated_at     DateTime        @updatedAt
  avatar_id      String?         @unique
  avatar         Images?         @relation(fields: [avatar_id], references: [id])
}

model StockTransaction {
  id               String          @id @default(uuid())
  item_id          String
  batch_id         String
  quantity         Int
  transaction_type TransactionType
  date             DateTime        @default(now())
  unit_price       Float
  total_price      Float
  supplier_id      String?
  remarks          String?
  created_at       DateTime        @default(now())
  updated_at       DateTime        @updatedAt
  batch            Batch           @relation(fields: [batch_id], references: [id])
  item             Item            @relation(fields: [item_id], references: [id])
  supplier         Supplier?       @relation(fields: [supplier_id], references: [id])
}

model Item {
  id             String             @id @default(uuid())
  name           String
  description    String?
  category       ResourceCategory
  unit_name      Unit
  unit_price     Float
  stock_quantity Int                @default(0)
  reorder_level  Int                @default(0)
  is_consumable  Boolean            @default(true)
  supplier_id    String?
  created_at     DateTime           @default(now())
  updated_at     DateTime           @updatedAt
  transactions   StockTransaction[]
  supplier       Supplier?          @relation(fields: [supplier_id], references: [id])
  Sales          Sales[]
}

model Batch {
  id                         String             @id @default(uuid())
  start_date                 DateTime           @default(now())
  expected_end_date          DateTime
  received_quantity          Int
  supplier_id                String?
  house_no                   Int
  created_at                 DateTime           @default(now())
  updated_at                 DateTime           @updatedAt
  is_from_registerd_supplier Boolean
  breed                      BirdBreed
  batch_id                   String             @unique
  farm_code                  String
  product_code               String
  sector_code                String
  supplier                   Supplier?          @relation(fields: [supplier_id], references: [id])
  DailyRecords               DailyRecords[]
  Environment                Environment[]
  Expenses                   Expenses[]
  Medications                Medications[]
  Sales                      Sales[]
  transactions               StockTransaction[]
  Vaccination                Vaccination[]

  @@index([farm_code, sector_code, product_code, batch_id])
}

model Medications {
  id                 String   @id @default(uuid())
  batch_id           String
  date               DateTime @default(now())
  medication_details String
  administered_by    String
  medicine_name      String
  dosage             String
  cause              String?
  period             String?
  doctor_id          String?
  remarks            String?
  created_at         DateTime @default(now())
  updated_at         DateTime @updatedAt
  admin              Admin    @relation(fields: [administered_by], references: [id])
  batch              Batch    @relation(fields: [batch_id], references: [id])
  doctor             Doctor?  @relation(fields: [doctor_id], references: [id])
}

model Vaccination {
  id              String   @id @default(uuid())
  batch_id        String
  date            DateTime @default(now())
  vaccine_details String?
  administered_by String
  vaccine_name    String
  dosage          Int
  cause           String?
  period          String?
  doctor_id       String?
  remarks         String?
  created_at      DateTime @default(now())
  updated_at      DateTime @updatedAt
  admin           Admin    @relation(fields: [administered_by], references: [id])
  batch           Batch    @relation(fields: [batch_id], references: [id])
  doctor          Doctor?  @relation(fields: [doctor_id], references: [id])
}

model Sales {
  id             String    @id @default(uuid())
  batch_id       String?
  item_id        String?
  date           DateTime  @default(now())
  delay_for_sale Int?
  quantity       Int
  unit_price     Float
  total_price    Float
  customer_id    String?
  created_at     DateTime  @default(now())
  updated_at     DateTime  @updatedAt
  batch          Batch?    @relation(fields: [batch_id], references: [id])
  item           Item?     @relation(fields: [item_id], references: [id])
  customer       Customer? @relation(fields: [customer_id], references: [id])
}

model Expenses {
  id          String           @id @default(uuid())
  batch_id    String?
  date        DateTime         @default(now())
  amount      Float
  unit        Unit
  category    ResourceCategory
  description String?
  created_at  DateTime         @default(now())
  updated_at  DateTime         @updatedAt
  remarks     String?
  batch       Batch?           @relation(fields: [batch_id], references: [id])
}

model DailyRecords {
  id                   String   @id @default(uuid())
  date                 DateTime @unique @default(now())
  batch_id             String
  mortality            Int      @default(0)
  feed_consumed_bags   Float?   @default(0)
  water_consumed_l     Float?   @default(0)
  avarage_weight_grams Float?   @default(0)
  created_at           DateTime @default(now())
  updated_at           DateTime @updatedAt
  batch                Batch    @relation(fields: [batch_id], references: [id])
}

model Environment {
  id               String     @id @default(uuid())
  batch_id         String
  house_no         Int
  temperature_c    Float
  humidity_percent Float
  ammonia_ppm      Float
  co2_ppm          Float
  air_pressure_hpa Float
  time_period      TimePeriod
  recorded_at      DateTime   @default(now())
  batch            Batch      @relation(fields: [batch_id], references: [id])
}

model Images {
  id         String      @id @default(uuid())
  public_id  String
  image_url  String
  createdAt  DateTime    @default(now())
  Admin      Admin?
  Customer   Customer?
  Doctor     Doctor?
  Employee   Employee?
  Pharmacist Pharmacist?
  Supplier   Supplier?
}

enum EmployeeRoleName {
  MANAGER
  WORKER
  INTERN
}

enum ContactMethod {
  WHATSAPP
  EMAIL
  IMO
  TELEGRAM
}

enum SupplierRoleName {
  SALES_MAN
  OWNER
  DISTRIBUTOR
  DEALER
  WHOLESALER
  RETAILER
  MANUFACTURER
  IMPORTER
  REPRESENTATIVE
}

enum TransactionType {
  PURCHASE
  SALE
  RETURN
  ADJUSTMENT
  DAMAGE
}

enum Unit {
  BIRD
  KG
  LITER
  BAG
  BOX
  UNIT
  OTHER
}

enum TimePeriod {
  MORNING
  NOON
  AFTERNOON
  EVENING
  NIGHT
  MIDNIGHT
  LATENIGHT
}

enum BirdBreed {
  CLASSIC
  HIBREED
  PAKISTHANI
  KEDERNATH
  FAOMI
  TIGER
}

enum ResourceCategory {
  FEED
  MEDICINE
  CHICKS
  HUSK
  EQUIPMENT
  UTILITIES
  SALARY
  TRANSPORTATION
  MAINTENANCE
  CLEANING_SUPPLIES
  OTHER
}

enum SupplierSupplyCategory {
  FEED
  MEDICINE
  CHICKS
  HUSK
  EQUIPMENT
  UTILITIES
  TRANSPORTATION
  CLEANING_SUPPLIES
  OFFICE_SUPPLIES
  SOFTWARE
  OTHER
}
